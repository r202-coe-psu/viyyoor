{% extends '/admin/index.html' %}

{% block breadcrumbs %}
{{ super() }}
{% if request.endpoint == 'admin.classes.index' %}
  <div class="active section">Classes</div>
{% else %}
  <a href="{{ url_for('admin.classes.index')}}" class="section">Classes</a>
{% endif %}
{% endblock %}

{% block dashboard_title %}
Classes
{% endblock %}

{% block content %}

{% if organization or "admin" in current_user.roles %}
  <div class="ui labeled icon menu">
    <a href="{{ url_for('admin.classes.create_or_edit') }}" class="item"><i class="add icon"></i>Add</a>
  </div>
  {% if classes %}
    <div style="margin-top: 1ex;">
      <table class="ui celled table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Organization</th>
            <th>Operation</th>
          </tr>
        </thead>
        <tbody>
      {% for class_ in classes %}
          <tr>
            <td>
              <a href="{{ url_for('admin.classes.view', class_id=class_.id) }}">{{ class_.name }}</a>
            </td>
            <td>
              {{ class_.description }}
            </td>
            <td>  
              {{ class_.organization.name }}
            </td>
            <td class="single line">
              <a class="ui circular button primary icon" href="{{ url_for('admin.classes.create_or_edit', class_id=class_.id) }}"><i class="edit icon"></i></a>
              <a class="ui circular button primary icon" href="{{ url_for('admin.classes.view', class_id=class_.id) }}"><i class="eye icon"></i></a>
              <a class="ui circular button primary icon" href="{{ url_for('admin.classes.copy', class_id=class_.id) }}"><i class="copy icon"></i></a>
              <a onclick="showDeleteModal('{{ class_.id }}')" class="ui circular button negative icon"><i class="trash icon"></i></a>

            <div class="ui small modal {{class_.id}}">
              <div class="header">Delete Class</div>
              <div class="content">
                <h4 class="ui headers" >
                  Are you sure you want to delete <span class="ui red text">{{ class_.name }}</span> class?
                </h4>
                <a class="ui right floated negative button" style="margin-bottom: 1em;" href="{{ url_for('admin.classes.delete', class_id=class_.id) }}">
                  Delete</i>
                </a>
                <button class="ui right floated button" onclick="showDeleteModal()">Cancel</button>
              </div>
					  </div>

            </td>
          </tr>
      {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}

{% else %}
<div class="ui segment">
    You need to select your organization in <a href=" {{ url_for('accounts.index') }}">Account Page</a> to show classes.
</div>
{% endif %}


{% endblock %}

{% block additional_js %}
<script>
    function showDeleteModal(Class__id) {
        Class__id ?  $('.ui.small.modal.'+Class__id).modal('show') : $('.ui.small.modal').modal('hide') 
    ;
    }
</script>
{% endblock %}